<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon Icon -->
    <link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicon.png">

    <title>Magnet Pattern in Scala</title>
    <meta name="description"
          content="Continuing from the previous post on Scala’s Cake Pattern, here is a quick explaination of the Magnet pattern.Magnet PatternYou are probably familiar with me...">

    <link rel="canonical" href="http://www.clianz.com/2016/04/26/scala-magnet-pattern/">
    <link rel="alternate" type="application/rss+xml" title="Clianz" href="http://www.clianz.com/feed.xml">

    <script type="text/javascript" src="/bower_components/jquery/dist/jquery.min.js"></script>

    <!-- Third-Party CSS -->
    <link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/bower_components/octicons/octicons/octicons.css">
    <link rel="stylesheet" href="/bower_components/hover/css/hover-min.css">
    <link rel="stylesheet" href="/bower_components/primer-markdown/dist/user-content.min.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">

    <!-- My CSS -->
    <link rel="stylesheet" href="/assets/css/common.css">

    <!-- CSS set in page -->
    

    <!-- CSS set in layout -->
    
    <link rel="stylesheet" href="/assets/css/sidebar-post-nav.css">
    

    <script type="text/javascript" src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

</head>


    <body>

    <header class="site-header">
    <div class="container">
        <a id="site-header-brand" href="/" title="Clianz">
            <span class="octicon octicon-mention"></span> Clianz
        </a>
        <nav class="site-header-nav" role="navigation">
            
            <a href="/"
               class=" site-header-nav-item hvr-underline-from-center"
               target=""
               title="Home">
                Home
            </a>
            
            <a href="/open-source"
               class=" site-header-nav-item hvr-underline-from-center"
               target=""
               title="Open-Source">
                Open-Source
            </a>
            
            <a href="/blog"
               class=" site-header-nav-item hvr-underline-from-center"
               target=""
               title="Blog">
                Blog
            </a>
            
        </nav>
    </div>
</header>


        <div class="content">
            <section class="jumbotron geopattern" data-pattern-id="Magnet Pattern in Scala">
    <div class="container">
        <div id="jumbotron-meta-info">
            <h1>Magnet Pattern in Scala</h1>
            <span class="meta-info">
                
                
                <span class="octicon octicon-calendar"></span> 2016/04/26
                
            </span>
        </div>
    </div>
</section>
<script>
    $(document).ready(function(){

        $('.geopattern').each(function(){
            $(this).geopattern($(this).data('pattern-id'));
        });

    });
</script>
<article class="post container" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="row">

        <div class="col-md-8 markdown-body">

            <p>Continuing from the previous post on Scala’s Cake Pattern, here is a quick explaination of the Magnet pattern.</p>

<h2 id="magnet-pattern">Magnet Pattern</h2>
<p>You are probably familiar with method overloading (ie. multiple method with the same name, but different parameter). This is very popular in Java, but is still not available in some modern languages like GoLang because designer to argue it clutters up the language.<br />
<!--more--></p>

<p>What do you do if you want a method that do different things with different parameter without overloading method? Simple answer is to pass in a single ‘object’ that encapsulate all the parameters and optional stuff you want. This is the Magnet pattern in a nutshell.</p>

<h3 id="the-implicit-magnet">The Implicit Magnet</h3>

<p>One of the nice features of Scala is ‘implicit’ method. Here you can define a method with ‘implicit’ tag, and when you didn’t call a method with the exact signature, the compiler will auto-magically find the best matching method to use to fill in the missing gap (implicitly).</p>

<h3 id="scala-magnet-pattern-example">Scala Magnet Pattern Example</h3>

<p>(<a href="https://github.com/icha024/HelloScala/blob/master2/HelloScala/src/main/scala/com/github/icha024/MyMagnetChecker.scala" target="_blank">github</a>)</p>

<p>Here is a little demo program to show this Magnet pattern.</p>

<p>Notice how MyMagnet is declared – I did not provide any ‘String’ or ‘Int’ type constructor. Scala is smart enough to find the matching implicit method for ‘String’ and ‘Int’ in my object and still construct it properly.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">package</span> <span class="nn">com.example</span>

<span class="k">object</span> <span class="nc">MyMagnetChecker</span> <span class="k">extends</span> <span class="nc">App</span> <span class="o">{</span>
  <span class="k">trait</span> <span class="nc">MyMagnet</span> <span class="o">{</span> <span class="c1">// should probably be sealed
</span>    <span class="k">type</span> <span class="kt">Result</span>
    <span class="k">def</span> <span class="n">getRes</span><span class="k">:</span> <span class="kt">Result</span>
    <span class="k">def</span> <span class="n">apply</span><span class="o">()</span><span class="k">:</span> <span class="kt">Result</span>
  <span class="o">}</span>

  <span class="k">object</span> <span class="nc">MyMagnet</span> <span class="o">{</span>
    <span class="k">implicit</span> <span class="k">def</span> <span class="n">convertFromInt</span><span class="o">(</span><span class="n">myVal</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyMagnet</span> <span class="o">{</span>
      <span class="k">override</span> <span class="k">type</span> <span class="kt">Result</span> <span class="o">=</span> <span class="nc">Int</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">apply</span><span class="o">()</span><span class="k">:</span> <span class="kt">Result</span> <span class="o">=</span> <span class="n">myVal</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">getRes</span><span class="k">:</span> <span class="kt">Result</span> <span class="o">=</span> <span class="n">myVal</span>
    <span class="o">}</span>

    <span class="k">implicit</span> <span class="k">def</span> <span class="n">convertFromString</span><span class="o">(</span><span class="n">myVal</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyMagnet</span> <span class="o">{</span>
      <span class="k">override</span> <span class="k">type</span> <span class="kt">Result</span> <span class="o">=</span> <span class="nc">String</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">apply</span><span class="o">()</span><span class="k">:</span> <span class="kt">Result</span> <span class="o">=</span> <span class="s">"Type is a String: "</span> <span class="o">+</span> <span class="n">myVal</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">getRes</span><span class="k">:</span> <span class="kt">Result</span> <span class="o">=</span> <span class="s">"String type: "</span> <span class="o">+</span> <span class="n">myVal</span>
    <span class="o">}</span>

    <span class="k">implicit</span> <span class="k">def</span> <span class="n">convertFromTwoString</span><span class="o">(</span><span class="n">myTuple</span><span class="k">:</span> <span class="o">(</span><span class="kt">String</span><span class="o">,</span> <span class="kt">String</span><span class="o">))</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyMagnet</span> <span class="o">{</span>
      <span class="k">override</span> <span class="k">type</span> <span class="kt">Result</span> <span class="o">=</span> <span class="nc">String</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">apply</span><span class="o">()</span><span class="k">:</span> <span class="kt">Result</span> <span class="o">=</span> <span class="s">"Type is a String type 2: "</span> <span class="o">+</span> <span class="n">myTuple</span><span class="o">.</span><span class="n">_1</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="n">myTuple</span><span class="o">.</span><span class="n">_2</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">getRes</span><span class="k">:</span> <span class="kt">Result</span> <span class="o">=</span> <span class="s">"String2 type: "</span> <span class="o">+</span> <span class="n">myTuple</span><span class="o">.</span><span class="n">_1</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="n">myTuple</span><span class="o">.</span><span class="n">_2</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="n">findStickyType</span><span class="o">(</span><span class="n">mag</span><span class="k">:</span> <span class="kt">MyMagnet</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="n">println</span><span class="o">(</span><span class="s">"Finding magnet of some type... "</span> <span class="o">+</span> <span class="n">mag</span><span class="o">.</span><span class="n">getRes</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="n">findStickyType</span><span class="o">(</span><span class="s">"abc"</span><span class="o">);</span> <span class="c1">// create 'MyMagnet' with String constructor
</span>  <span class="n">findStickyType</span><span class="o">(</span><span class="mi">123</span><span class="o">);</span>   <span class="c1">// create 'MyMagnet' with Int constructor
</span>  <span class="n">findStickyType</span><span class="o">(</span><span class="s">"xyz"</span><span class="o">,</span><span class="s">"ijk"</span><span class="o">);</span>   <span class="c1">// create 'MyMagnet' with (String, String) tuple constructor
</span>
  <span class="c1">// Magnet pattern = Instead of method overloading, we use one big pojo with variable amount of fields.
</span>  <span class="c1">// Then instead of messy if/else checks on each field of the big pojo to run different init, we use 'implicit' method feature of Scala.
</span><span class="o">}</span>
</code></pre>
</div>


            <!-- Comments -->
            <div class="comments">
    <div id="disqus_thread"></div>
    <script>
        /**
         * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
         * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
         */
        /*
         var disqus_config = function () {
         this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
         this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
         };
         */
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');

            s.src = '///embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>

        </div>

        <div class="col-md-4">
            <h3>Post Directory</h3>
<div id="post-directory-module">
<section class="post-directory">
    <!-- Links that trigger the jumping -->
    <!-- Added by javascript below -->
    <dl></dl>
</section>
</div>

<script type="text/javascript">

    $(document).ready(function(){
        $( "article h2" ).each(function( index ) {
            $(".post-directory dl").append("<dt><a class=\"jumper\" hre=#" +
                    $(this).attr("id")
                    + ">"
                    + $(this).text()
                    + "</a></dt>");

            var children = $(this).nextUntil("h2", "h3")

            children.each(function( index ) {
                $(".post-directory dl").append("<dd><a class=\"jumper\" hre=#" +
                        $(this).attr("id")
                        + ">"
                        + "&nbsp;&nbsp;- " + $(this).text()
                        + "</a></dd>");
            });
        });

        var fixmeTop = $('#post-directory-module').offset().top - 100;       // get initial position of the element

        $(window).scroll(function() {                  // assign scroll event listener

            var currentScroll = $(window).scrollTop(); // get current position

            if (currentScroll >= fixmeTop) {           // apply position: fixed if you
                $('#post-directory-module').css({      // scroll to that element or below it
                    top: '100px',
                    position: 'fixed',
                    width: 'inherit'
                });
            } else {                                   // apply position: static
                $('#post-directory-module').css({      // if you scroll above it
                    position: 'inherit',
                    width: 'inherit'
                });
            }

        });

        $("a.jumper").on("click", function( e ) {

            e.preventDefault();

            $("body, html").animate({
                scrollTop: ($( $(this).attr('hre') ).offset().top - 100)
            }, 600);

        });
    });

</script>
        </div>

    </div>

</article>

        </div>

    <footer class="container">

    <div class="site-footer">

        <div class="copyright pull-left">
            <!-- 请不要更改这一行 方便其他人知道模板的来源 谢谢 -->
            <!-- Please keep this line to let others know where this theme comes from. Thank you :D -->
            Power by <a href="https://github.com/DONGChuan/Yummy-Jekyll">Yummy Jekyll</a>
        </div>

        <!--<a href="https://github.com/DONGChuan" target="_blank" aria-label="view source code">
            <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
        </a>-->

        <div class="pull-right">
            <a href="javascript:window.scrollTo(0,0)" >TOP</a>
        </div>

    </div>

    <!-- Third-Party JS -->
    <script type="text/javascript" src="/bower_components/geopattern/js/geopattern.min.js"></script>

    <!-- My JS -->
    <script type="text/javascript" src="/assets/js/script.js"></script>

    

    <!-- Google Analytics -->
    <div style="display:none">
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-71716738-1', 'auto');
            ga('send', 'pageview');

        </script>
    </div>

</footer>


    </body>

</html>
