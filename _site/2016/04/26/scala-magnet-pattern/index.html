<!DOCTYPE html>
<html>

  <head>
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  
  <title>Magnet Pattern in Scala</title>
  <meta name="description" content="Continuing from the previous post on Scala’s Cake Pattern, here is a quick explaination of the Magnet pattern.Magnet PatternYou are probably familiar with me...">

  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width initial-scale=1">

  <link rel="shortcut icon" href="">


  
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:400,700,400italic,700italic|Open+Sans:400italic,700italic,700,400">
  <link rel="stylesheet" href="/css/screen.css">

  
  <link rel="canonical" href="/2016/04/26/scala-magnet-pattern/">
  <link rel="alternate" type="application/atom+xml" title="Clianz: Tech and stuff from NZ" href="/feed.xml" />

  <script type="text/javascript" src="/assets/javascripts/jquery-2.1.4.min.js"></script>
</head>


  <body class="">

    

<article role="main" class="">
    <header>
      <a href="/" id="home_link">«</a>
      <div class="meta"><time datetime="2016-04-26"><a href="/2016/04/26/scala-magnet-pattern/">April 26, 2016</a></time>
        <span class="count" id="js-reading-time">&nbsp;</span>
      </div>
      <h1>Magnet Pattern in Scala</h1>
    </header>

    <div class="text" id="js-post-content">
        <p>Continuing from the previous post on Scala’s Cake Pattern, here is a quick explaination of the Magnet pattern.</p>

<h2 id="magnet-pattern">Magnet Pattern</h2>
<p>You are probably familiar with method overloading (ie. multiple method with the same name, but different parameter). This is very popular in Java, but is still not available in some modern languages like GoLang because designer to argue it clutters up the language.
<!--more--></p>

<p>What do you do if you want a method that do different things with different parameter without overloading method? Simple answer is to pass in a single ‘object’ that encapsulate all the parameters and optional stuff you want. This is the Magnet pattern in a nutshell.</p>

<h3 id="the-implicit-magnet">The Implicit Magnet</h3>

<p>One of the nice features of Scala is ‘implicit’ method. Here you can define a method with ‘implicit’ tag, and when you didn’t call a method with the exact signature, the compiler will auto-magically find the best matching method to use to fill in the missing gap (implicitly).</p>

<h3 id="scala-magnet-pattern-example">Scala Magnet Pattern Example</h3>

<p>(<a href="https://github.com/icha024/HelloScala/blob/master2/HelloScala/src/main/scala/com/github/icha024/MyMagnetChecker.scala" target="_blank">github</a>)</p>

<p>Here is a little demo program to show this Magnet pattern.</p>

<p>Notice how MyMagnet is declared – I did not provide any ‘String’ or ‘Int’ type constructor. Scala is smart enough to find the matching implicit method for ‘String’ and ‘Int’ in my object and still construct it properly.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">package</span> <span class="nn">com.example</span>

<span class="k">object</span> <span class="nc">MyMagnetChecker</span> <span class="k">extends</span> <span class="nc">App</span> <span class="o">{</span>
  <span class="k">trait</span> <span class="nc">MyMagnet</span> <span class="o">{</span> <span class="c1">// should probably be sealed
</span>    <span class="k">type</span> <span class="kt">Result</span>
    <span class="k">def</span> <span class="n">getRes</span><span class="k">:</span> <span class="kt">Result</span>
    <span class="k">def</span> <span class="n">apply</span><span class="o">()</span><span class="k">:</span> <span class="kt">Result</span>
  <span class="o">}</span>

  <span class="k">object</span> <span class="nc">MyMagnet</span> <span class="o">{</span>
    <span class="k">implicit</span> <span class="k">def</span> <span class="n">convertFromInt</span><span class="o">(</span><span class="n">myVal</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyMagnet</span> <span class="o">{</span>
      <span class="k">override</span> <span class="k">type</span> <span class="kt">Result</span> <span class="o">=</span> <span class="nc">Int</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">apply</span><span class="o">()</span><span class="k">:</span> <span class="kt">Result</span> <span class="o">=</span> <span class="n">myVal</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">getRes</span><span class="k">:</span> <span class="kt">Result</span> <span class="o">=</span> <span class="n">myVal</span>
    <span class="o">}</span>

    <span class="k">implicit</span> <span class="k">def</span> <span class="n">convertFromString</span><span class="o">(</span><span class="n">myVal</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyMagnet</span> <span class="o">{</span>
      <span class="k">override</span> <span class="k">type</span> <span class="kt">Result</span> <span class="o">=</span> <span class="nc">String</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">apply</span><span class="o">()</span><span class="k">:</span> <span class="kt">Result</span> <span class="o">=</span> <span class="s">"Type is a String: "</span> <span class="o">+</span> <span class="n">myVal</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">getRes</span><span class="k">:</span> <span class="kt">Result</span> <span class="o">=</span> <span class="s">"String type: "</span> <span class="o">+</span> <span class="n">myVal</span>
    <span class="o">}</span>

    <span class="k">implicit</span> <span class="k">def</span> <span class="n">convertFromTwoString</span><span class="o">(</span><span class="n">myTuple</span><span class="k">:</span> <span class="o">(</span><span class="kt">String</span><span class="o">,</span> <span class="kt">String</span><span class="o">))</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyMagnet</span> <span class="o">{</span>
      <span class="k">override</span> <span class="k">type</span> <span class="kt">Result</span> <span class="o">=</span> <span class="nc">String</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">apply</span><span class="o">()</span><span class="k">:</span> <span class="kt">Result</span> <span class="o">=</span> <span class="s">"Type is a String type 2: "</span> <span class="o">+</span> <span class="n">myTuple</span><span class="o">.</span><span class="n">_1</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="n">myTuple</span><span class="o">.</span><span class="n">_2</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">getRes</span><span class="k">:</span> <span class="kt">Result</span> <span class="o">=</span> <span class="s">"String2 type: "</span> <span class="o">+</span> <span class="n">myTuple</span><span class="o">.</span><span class="n">_1</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="n">myTuple</span><span class="o">.</span><span class="n">_2</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="n">findStickyType</span><span class="o">(</span><span class="n">mag</span><span class="k">:</span> <span class="kt">MyMagnet</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="n">println</span><span class="o">(</span><span class="s">"Finding magnet of some type... "</span> <span class="o">+</span> <span class="n">mag</span><span class="o">.</span><span class="n">getRes</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="n">findStickyType</span><span class="o">(</span><span class="s">"abc"</span><span class="o">);</span> <span class="c1">// create 'MyMagnet' with String constructor
</span>  <span class="n">findStickyType</span><span class="o">(</span><span class="mi">123</span><span class="o">);</span>   <span class="c1">// create 'MyMagnet' with Int constructor
</span>  <span class="n">findStickyType</span><span class="o">(</span><span class="s">"xyz"</span><span class="o">,</span><span class="s">"ijk"</span><span class="o">);</span>   <span class="c1">// create 'MyMagnet' with (String, String) tuple constructor
</span>
  <span class="c1">// Magnet pattern = Instead of method overloading, we use one big pojo with variable amount of fields.
</span>  <span class="c1">// Then instead of messy if/else checks on each field of the big pojo to run different init, we use 'implicit' method feature of Scala.
</span><span class="o">}</span>
</code></pre>
</div>

    </div>

    <menu>
      <a href="" id="btn_share" class="btn" title="Share">
        <span aria-hidden="true" data-icon="S"></span>
        <strong>Share</strong>
      </a>
      <a href="http://twitter.com/share?text=Magnet+Pattern+in+Scala&url=/2016/04/26/scala-magnet-pattern/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" id="btn_comment" class="btn" target="_blank">
        <span aria-hidden="true" data-icon="C"></span> Comment on Twitter
      </a>
    </menu>
</article>

<footer role="contentinfo" class='post-footer'>
    <div class="inner">
        <div class="vcard">
            <a href="/feed.xml" id="btn_feed" class="btn" title="Feed" target="_blank">
                <span aria-hidden="true" data-icon=")"></span>
                <strong>Feed</strong>
            </a>

            

            <div class="details">
                <h4><a href="" class="url n">Clianz: Tech and stuff from NZ</a></h4>
                <a href="" class="js-remove-domain-schema"></a><br>
            </div>
        </div>
        <div id="user_bio">
            <div class="inner">
                Thoughts exploration on software, hardware, and all things in technology.

            </div>
        </div>
    </div>
</footer>

<div id="share_modal">
    <div class="wrap">
        <div class="inner">
            <header>
                Share
                <a href="" class="close" title="Close">&times;</a>
            </header>

            <div class="roon-share-links">
                <a href="https://twitter.com/share" class="twitter-share-button" data-dnt="true">Tweet</a>
                <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

                <div id="fb-elems">
                    <div id="fb-root"></div>
                    <script>(function(d, s, id) {
                    var js, fjs = d.getElementsByTagName(s)[0];
                    if (d.getElementById(id)) return;
                    js = d.createElement(s); js.id = id;
                    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=463438580397968";
                    fjs.parentNode.insertBefore(js, fjs);
                    }(document, 'script', 'facebook-jssdk'));</script>
                    <div class="fb-like" data-send="false" data-layout="button_count" data-width="110" data-show-faces="false" data-font="arial"></div>
                </div>

                <div id="pinit-btn">
                    <a href="//pinterest.com/pin/create/button/?url=/2016/04/26/scala-magnet-pattern/&amp;description=Magnet Pattern in Scala-Clianz: Tech and stuff from NZ " data-pin-do="buttonPin" data-pin-config="beside"><img src="//assets.pinterest.com/images/pidgets/pin_it_button.png"></a>
                    <script type="text/javascript" src="//assets.pinterest.com/js/pinit.js"></script>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
window.onload = function () {
  reading_time();
}
function get_text(el) {
  ret = "";
  var length = el.childNodes.length;
  for(var i = 0; i < length; i++) {
    var node = el.childNodes[i];
    if(node.nodeType != 8) {
      ret += node.nodeType != 1 ? node.nodeValue : get_text(node);
    }
  }
  return ret;
}
function reading_time () {
  var post_content = document.getElementById('js-post-content');
  if (post_content) {
    var words = get_text(post_content),
      count = words.split(/\s+/).length,
    read_time = Math.ceil((count / 150)),
        read_time_node = document.createTextNode(read_time + ' min read');
    document.getElementById('js-reading-time').appendChild(read_time_node);
  }
}
$(function(){
  var share_modal = $("#share_modal"),
  update_social_links = true;

  $("#btn_share").click(function(){
    var that = $(this);
    share_modal.fadeIn(200);
    return false;
  });

  share_modal.click(function(e){
    if (e.target.className == "wrap" || e.target.id == "share_modal") {
      share_modal.fadeOut(200);
    }
    return false;
  });

  share_modal.find("div.inner > header > a.close").click(function(){
    share_modal.fadeOut(200);
    return false;
  });
});
</script>


    <!--
    
    <a href="" id="blog_badge">
            <span style="background-image:
            url('/assets/images/');"></span>
        </a>
    
    -->

    <script>
      function no_schema_links () {
        var links = document.querySelectorAll('.js-remove-domain-schema');
        if (links) {
          for (i = 0; i < links.length; ++i) {
            var link = links[i],
              text = link.innerHTML,
            no_schema = text.replace(/.*?:\/\//g, "");
            link.innerHTML = no_schema;
          }
        }
      }

      window.onload = function () {
        no_schema_links();
      }
    </script>
  </body>

</html>
